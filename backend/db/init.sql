CREATE TYPE quest_state AS ENUM ('pending', 'verified', 'denied');

CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
    name VARCHAR(255) UNIQUE NOT NULL,
    mail VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(64) NOT NULL,
    is_admin boolean DEFAULT false NOT NULL,
    points integer DEFAULT 0 NOT NULL,
    last_active date DEFAULT NOW() NOT NULL,
    longest_streak integer DEFAULT 0 NOT NULL,
    current_streak integer DEFAULT 0 NOT NULL
);

CREATE TABLE quests (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
    name VARCHAR(50) NOT NULL,
    description VARCHAR(250) NOT NULL,
    points_received integer NOT NULL,
    required_points integer NOT NULL
);

CREATE TABLE user_quest (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
    quest_id UUID NOT NULL,
    user_id UUID NOT NULL,
    progress quest_state,
    proof_path VARCHAR(255),


    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (quest_id) REFERENCES quests(id)
);

CREATE TABLE personal_challanges (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
    name VARCHAR(50) NOT NULL,
    description VARCHAR(255) NOT NULL,
    user_id UUID NOT NULL,
    priority INT NOT NULL,
    category VARCHAR(40) NOT NULL,

    FOREIGN KEY (user_id) REFERENCES users(id)
);


INSERT INTO users (id, name, mail, password_hash, is_admin, points) VALUES(gen_random_uuid(), 'admin', 'admin@example.com', '0', true, 10);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('Заземяване „Ресет“', '3-минутно заземяване: бавно дишане + назови 5 неща, които виждаш около себе си. Минимално усилие, подходящо при ниска енергия.', 9, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('Емоционален „Синхрон“', 'Напиши кратък журнал от 2–3 изречения: „Как се чувствам в момента и какво може да е причината?“ Лека саморефлексия.', 18, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Слънчев заряд“', 'Излез за 1–2 минути на естествена светлина и направи снимка. Леко движение + контакт със слънчева светлина.', 27, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Хранене без телефон“', 'Изяж едно хранене или изпий напитка без да докосваш телефона. Управление на навик, но лесно изпълнимо.', 36, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„30-минутен дигитален детокс“', '30 минути по таймер без телефон и социални мрежи. Изисква дисциплина, но времето е кратко.', 45, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Спокойната стъпка“', 'Бавна mindful разходка за 2–4 минути — направи снимка на нещо, което ти е направило впечатление. Комбинация от движение + внимание към настоящето.', 54, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Мини организация“', 'Отдели 5 минути да подредиш малка зона: бюро, рафт, чанта или само едно чекмедже. Малко физическо усилие, но с видим резултат.', 63, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Природна контролна точка“', 'Излез на кратка разходка в по-природна среда и направи снимка на дърво, небе или пейзаж. Изисква повече време и напускане на дома.', 72, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Балон на фокуса“', '10–15 минути дълбока работа без разсейване — снимай резултата (бележки, код, подредено място). Силен контрол на вниманието + самодисциплина.', 81, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Капка доброта“', 'Извърши малък акт на добрина: съобщение за благодарност, извинение, подкрепящо послание или комплимент. Емоционално най-изискващо — изисква смелост и емпатия.', 90, 9);

INSERT INTO quests (name, description, points_received, required_points) VALUES
('5 минути дълбоко дишане', 'Кратка пауза, която рестартира ума ти и сваля напрежението.', 10, 10),
('3 неща, за които си благодарен', 'Малък ритуал за промяна на гледната точка.', 10, 10),
('Снимка на нещо красиво', 'Тренира окото да намира красотата в ежедневието.', 10, 10),
('1 час без телефон', 'Цифрова тишина за повече концентрация.', 10, 10),
('20 клека', 'Мини тренировка за енергия и усещане за успех.', 10, 10),
('Комплимент на непознат', 'Мъничък жест, който осветява деня.', 10, 10),
('Стълбите вместо асансьор', 'Малко движение с голям ефект.', 10, 10),
('Пий 2 литра вода', 'Хидратацията подобрява енергията и яснотата.', 10, 10),
('Снимай 3 абстрактни форми', 'Открий изкуството в малките детайли.', 10, 10),
('Благодарствено съобщение', 'Изпрати сърдечно съобщение на някого.', 10, 10),
('Сутрин без телефон', 'Първия час след сън — без екран.', 10, 10),
('10 минути медитация', 'Кратка водена медитация за спокойствие.', 10, 10),
('5-минутно бързо рисуване', 'Рисувай за удоволствие.', 10, 10),
('Здравословна закуска', 'Започни деня с полезна храна.', 10, 10),
('0 храна в коша', 'Планирай така, че да не изхвърлиш нищо.', 10, 10),
('30 минути тишина', 'Пълна тишина за рестарт на ума.', 10, 10),
('30-минутна йога', 'Разтягане и релакс за тялото.', 10, 10),
('1 минута планк', 'Кратко, но огнено упражнение.', 10, 10);

INSERT INTO quests (name, description, points_received, required_points) VALUES
('Без социални мрежи след 20:00', 'Подари си спокойна вечер.', 15, 15),
('15-минутна разходка сред природа', 'Свързва те с природата и намалява стреса.', 15, 15),
('Пеша или колело вместо кола', 'Мини принос към природата + здраве.', 15, 15),
('Помогни на възрастен човек', 'Малък жест със силен ефект.', 15, 15),
('10 снимки на тема зелено', 'Творческо предизвикателство за детайлите.', 15, 15),
('Без телефон по време на хранене', 'Преоткрий вкуса на храната.', 15, 15),
('Мини-разказ от 5 изречения', 'Кратко творческо упражнение.', 15, 15),
('Обади се на близък човек', 'Засилва връзките и топли сърцето.', 15, 15),
('Малко добро дело', 'Помогни с нещо дребно.', 15, 15),
('10-минутна тренировка', 'Кратка, ефективна и освежаваща.', 15, 15),
('Ограничи известията', 'Премахни дигиталния шум.', 15, 15),
('Изслушай някого 5 минути', 'Истинско внимание без прекъсване.', 15, 15),
('Създай малка DIY украса', 'Творчески проект с подръчни материали.', 15, 15),
('Разходка без цел', 'Просто тръгни и се наслади.', 15, 15),
('Един ден без слушалки', 'Чуй света осъзнато.', 15, 15),
('Един ден на локални продукти', 'Подкрепи местните производители.', 15, 15),
('Открий свой спокоен ъгъл', 'Място за релакс и презареждане.', 15, 15),
('10000 крачки', 'Простo и полезно ежедневие.', 15, 15);

INSERT INTO quests (name, description, points_received, required_points) VALUES
('Спорт на открито 20 минути', 'Тичане, скачане или стречинг — важното е движението.', 30, 30),
('Седмица без пластмасова бутилка', 'Намалява отпадъците и показва ангажираност.', 30, 30),
('Засади растение', 'Оставяш след себе си нещо живо.', 30, 30),
('Мини-градина на балкона', 'Проект с грижа и постоянство.', 30, 30),
('Събиране на отпадъци', 'Подобрява средата и дава пример.', 30, 30),
('Организирай разходка с приятели', 'Изисква планиране и инициатива.', 30, 30),
('Личен дневник 3 дни', 'Дълбок процес за себепознание.', 30, 30),
('Колаж за настроение', 'Творчески проект за емоциите.', 30, 30),
('24-часова дигитална почивка', 'Истински рестарт без екрани.', 30, 30),
('Дай втори живот на предмет', 'Поправи или преработи нещо старо.', 30, 30),
('Писмо до бъдещото си Аз', 'Сподели мечтите и целите си.', 30, 30);
