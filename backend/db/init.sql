CREATE TYPE quest_state AS ENUM ('pending', 'verified', 'denied');

CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
    name VARCHAR(255) UNIQUE NOT NULL,
    mail VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(64) NOT NULL,
    is_admin boolean DEFAULT false NOT NULL,
    points integer DEFAULT 0 NOT NULL,
    last_active date DEFAULT NOW() NOT NULL,
    longest_streak integer DEFAULT 0 NOT NULL,
    current_streak integer DEFAULT 0 NOT NULL,
    completed_weekly date DEFAULT NULL
);

CREATE TABLE quests (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
    name VARCHAR(50) NOT NULL,
    description VARCHAR(250) NOT NULL,
    points_received integer NOT NULL,
    required_points integer NOT NULL
);

CREATE TABLE user_quest (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
    quest_id UUID NOT NULL,
    user_id UUID NOT NULL,
    completed_at date DEFAULT NOW(),
    proof_path TEXT,
    progress quest_state,


    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (quest_id) REFERENCES quests(id)
);

CREATE TABLE personal_challanges (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
    name VARCHAR(50) NOT NULL,
    description VARCHAR(255) NOT NULL,
    user_id UUID NOT NULL,
    priority INT NOT NULL,
    category VARCHAR(40) NOT NULL,

    FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE TABLE diary (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
    content VARCHAR(255) NOT NULL,
    "date" date DEFAULT NOW() NOT NULL,
    mood VARCHAR(10) NOT NULL,
    user_id UUID NOT NULL,

    FOREIGN KEY (user_id) REFERENCES users(id)
);


INSERT INTO users (id, name, mail, password_hash, is_admin, points) VALUES(gen_random_uuid(), 'admin', 'admin@example.com', '0', true, 10);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('Заземяване „Ресет“', '3-минутно заземяване: бавно дишане + назови 5 неща, които виждаш около себе си. Минимално усилие, подходящо при ниска енергия.', 9, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('Емоционален „Синхрон“', 'Напиши кратък журнал от 2–3 изречения: „Как се чувствам в момента и какво може да е причината?“ Лека саморефлексия.', 18, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Слънчев заряд“', 'Излез за 1–2 минути на естествена светлина и направи снимка. Леко движение + контакт със слънчева светлина.', 27, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Хранене без телефон“', 'Изяж едно хранене или изпий напитка без да докосваш телефона. Управление на навик, но лесно изпълнимо.', 36, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„30-минутен дигитален детокс“', '30 минути по таймер без телефон и социални мрежи. Изисква дисциплина, но времето е кратко.', 45, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Спокойната стъпка“', 'Бавна разходка за 2–4 минути — направи снимка на нещо, което ти е направило впечатление. Комбинация от движение + внимание към настоящето.', 54, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Мини организация“', 'Отдели 5 минути да подредиш малка зона: бюро, рафт, чанта или само едно чекмедже. Малко физическо усилие, но с видим резултат.', 63, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Природна контролна точка“', 'Излез на кратка разходка в по-природна среда и направи снимка на дърво, небе или пейзаж. Изисква повече време и напускане на дома.', 72, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Балон на фокуса“', '10–15 минути дълбока работа без разсейване — снимай резултата (бележки, код, подредено място). Силен контрол на вниманието + самодисциплина.', 81, 9);

INSERT INTO quests (name, description, required_points, points_received) VALUES
('„Капка доброта“', 'Извърши малък акт на добрина: съобщение за благодарност, извинение, подкрепящо послание или комплимент. Емоционално най-изискващо — изисква смелост и емпатия.', 90, 9);

INSERT INTO quests (name, description, points_received, required_points) VALUES
('5 минути дълбоко дишане', 'Кратка пауза, която рестартира ума ти и сваля напрежението.', 10, 10),
('3 неща, за които си благодарен', 'Малък ритуал за промяна на гледната точка.', 10, 10),
('Снимка на нещо красиво', 'Тренира окото да намира красотата в ежедневието.', 10, 10),
('1 час без телефон', 'Цифрова тишина за повече концентрация.', 10, 10),
('20 клека', 'Мини тренировка за енергия и усещане за успех.', 10, 10),
('Комплимент на непознат', 'Мъничък жест, който осветява деня.', 10, 10),
('Стълбите вместо асансьор', 'Малко движение с голям ефект.', 10, 10),
('Пий 2 литра вода', 'Хидратацията подобрява енергията и яснотата.', 10, 10),
('Снимай 3 абстрактни форми', 'Открий изкуството в малките детайли.', 10, 10),
('Благодарствено съобщение', 'Изпрати сърдечно съобщение на някого.', 10, 10),
('Сутрин без телефон', 'Първия час след сън — без екран.', 10, 10),
('10 минути медитация', 'Кратка водена медитация за спокойствие.', 10, 10),
('5-минутно бързо рисуване', 'Рисувай за удоволствие.', 10, 10),
('Здравословна закуска', 'Започни деня с полезна храна.', 10, 10),
('0 храна в коша', 'Планирай така, че да не изхвърлиш нищо.', 10, 10),
('30 минути тишина', 'Пълна тишина за рестарт на ума.', 10, 10),
('30-минутна йога', 'Разтягане и релакс за тялото.', 10, 10),
('3 осъзнати вдишвания', 'Спри и дишай бавно в продължение на 60 секунди.', 10, 10),
('Поглед нагоре', '1 минута гледай небето и се замисли.', 10, 10),
('Една дума за днес', 'Опиши деня си само с една дума.', 10, 10),
('Разтягане на врата', '2 минути леки и бавни движения.', 10, 10),
('Без звук', 'Изключи всички звуци за 3 минути.', 10, 10),
('Микро победа', 'Завърши нещо съвсем дребно.', 10, 10),
('Осъзната глътка', 'Изпий вода бавно и без разсейване.', 10, 10),
('Чист екран', 'Затвори всички ненужни табове.', 10, 10),
('Добра мисъл', 'Помисли нещо хубаво за друг човек.', 10, 10),
('Изправена стойка', 'Поддържай правилна стойка 1 минута.', 10, 10),
('Без мърдане', 'Стой неподвижно 60 секунди.', 10, 10),
('Мини усмивка', 'Усмихни се съзнателно.', 10, 10),
('Дълбок въпрос', 'Задай си въпроса „Как съм всъщност?“', 10, 10),
('Мини тишина', '2 минути без никакви звуци.', 10, 10),
('Емоция чек', 'Назови текущата си емоция.', 10, 10),
('Бавно мигане', 'Отпусни очите с бавно мигане 1 минута.', 10, 10),
('Пауза без вина', 'Почини си 2 минути без чувство за вина.', 10, 10),
('Мини благодарност', 'Благодарност за нещо съвсем малко.', 10, 10),
('Рестарт на мисъл', 'Спри негативна мисъл съзнателно.', 10, 10),
('Тук и сега', 'Назови 3 неща около себе си.', 10, 10),
('1 минута планк', 'Кратко, но огнено упражнение.', 10, 10);

INSERT INTO quests (name, description, points_received, required_points) VALUES
('Без социални мрежи след 20:00', 'Подари си спокойна вечер.', 15, 15),
('15-минутна разходка сред природа', 'Свързва те с природата и намалява стреса.', 15, 15),
('Пеша или колело вместо кола', 'Мини принос към природата + здраве.', 15, 15),
('Помогни на възрастен човек', 'Малък жест със силен ефект.', 15, 15),
('10 снимки на тема зелено', 'Творческо предизвикателство за детайлите.', 15, 15),
('Без телефон по време на хранене', 'Преоткрий вкуса на храната.', 15, 15),
('Мини-разказ от 5 изречения', 'Кратко творческо упражнение.', 15, 15),
('Обади се на близък човек', 'Засилва връзките и топли сърцето.', 15, 15),
('Малко добро дело', 'Помогни с нещо дребно.', 15, 15),
('10-минутна тренировка', 'Кратка, ефективна и освежаваща.', 15, 15),
('Ограничи известията', 'Премахни дигиталния шум.', 15, 15),
('Изслушай някого 5 минути', 'Истинско внимание без прекъсване.', 15, 15),
('Създай малка DIY украса', 'Творчески проект с подръчни материали.', 15, 15),
('Разходка без цел', 'Просто тръгни и се наслади.', 15, 15),
('Един ден без слушалки', 'Чуй света осъзнато.', 15, 15),
('Един ден на локални продукти', 'Подкрепи местните производители.', 15, 15),
('Открий свой спокоен ъгъл', 'Място за релакс и презареждане.', 15, 15),
('Разходка без слушалки', '10 минути разходка без аудио.', 15, 15),
('Мини писане', 'Напиши 10 изречения без редакция.', 15, 15),
('Фокусен блок', '15 минути работа върху една задача.', 15, 15),
('Сортиране', 'Подреди една малка категория.', 15, 15),
('Тяло чек', 'Сканирай напрежението в тялото си.', 15, 15),
('Креативна снимка', 'Заснеми сянка, линия или текстура.', 15, 15),
('Пауза навън', '5–10 минути навън.', 15, 15),
('Мини план', 'Направи план за остатъка от деня.', 15, 15),
('Бавно хранене', 'Храни се бавно и осъзнато.', 15, 15),
('Топъл жест', 'Изпрати кратко мило съобщение.', 15, 15),
('Емоционално писмо', 'Напиши писмо без да го изпращаш.', 15, 15),
('Без multitasking', 'Прави само едно нещо наведнъж.', 15, 15),
('Мини прочистване', 'Изхвърли или дари 3 неща.', 15, 15),
('Съзнателно движение', '10 минути леко раздвижване.', 15, 15),
('Фокус без таймер', 'Работи, докато усетиш край.', 15, 15),
('Микро избор', 'Направи съзнателен малък избор.', 15, 15),
('Спри автоматизма', 'Прекъсни рутинно действие.', 15, 15),
('Подреди мисли', 'Напиши списък „в главата ми“.', 15, 15),
('Творчески експеримент', 'Опитай нещо ново и малко.', 15, 15),
('Само за теб', '15 минути само за теб.', 15, 15),
('10000 крачки', 'Простo и полезно ежедневие.', 15, 15);

INSERT INTO quests (name, description, points_received, required_points) VALUES
('Спорт на открито 20 минути', 'Тичане, скачане или стречинг — важното е движението.', 30, 30),
('Седмица без пластмасова бутилка', 'Намалява отпадъците и показва ангажираност.', 30, 30),
('Засади растение', 'Оставяш след себе си нещо живо.', 30, 30),
('Мини-градина на балкона', 'Проект с грижа и постоянство.', 30, 30),
('Събиране на отпадъци', 'Подобрява средата и дава пример.', 30, 30),
('Организирай разходка с приятели', 'Изисква планиране и инициатива.', 30, 30),
('Личен дневник 3 дни', 'Дълбок процес за себепознание.', 30, 30),
('Колаж за настроение', 'Творчески проект за емоциите.', 30, 30),
('24-часова дигитална почивка', 'Истински рестарт без екрани.', 30, 30),
('Дай втори живот на предмет', 'Поправи или преработи нещо старо.', 30, 30),
('Честен списък', 'Запиши какво отлагаш.', 30, 30),
('Една истина', 'Напиши нещо трудно за себе си.', 30, 30),
('Без сравнение 24ч', '24 часа без сравнение с другите.', 30, 30),
('Постави граница', 'Откажи нещо ненужно.', 30, 30),
('Труден разговор', 'Планирай разговор, който избягваш.', 30, 30),
('Дълбока работа', '45 минути дълбок фокус.', 30, 30),
('Без самокритика', 'Цял ден само наблюдение.', 30, 30),
('Социална инициатива', 'Ти започваш контакта.', 30, 30),
('Страх – стъпка', 'Малка стъпка към страх.', 30, 30),
('Без оправдания', 'Назови реалните причини.', 30, 30),
('Емоционална смелост', 'Кажи как се чувстваш.', 30, 30),
('Тишина 30 минути', '30 минути пълна тишина.', 30, 30),
('Едно докрай', 'Завърши едно нещо напълно.', 30, 30),
('Самонаблюдение', 'Записвай реакциите си.', 30, 30),
('Сложна задача първа', 'Започни с най-трудното.', 30, 30),
('Пауза от токсичност', 'Почивка от негативен човек.', 30, 30),
('Дискомфорт по избор', 'Избери умишлен дискомфорт.', 30, 30),
('Огледало', 'Запиши 5 свои силни страни.', 30, 30),
('Съзнателно забавяне', 'Забави темпото за целия ден.', 30, 30),
('Поеми отговорност', 'Поеми вина за нещо.', 30, 30),
('Писмо до бъдещото си Аз', 'Сподели мечтите и целите си.', 30, 30);

INSERT INTO quests (name, description, points_received, required_points) VALUES
('7 дни сутрешна тишина','Започвай всяка сутрин с 3–5 минути тишина без телефон, музика или разговори, за да създадеш спокоен старт на деня.', 50, 0),
('7 дни без вечерно скролване', 'След определен час (например 21:00) избягвай социални мрежи и безцелно скролване, за да дадеш почивка на ума си.', 50, 0),
('Седмица с дневник', 'Всеки ден записвай по 1–3 изречения за мислите или емоциите си с цел осъзнатост, не перфектно писане.', 50, 0),
('Седмица без оплаквания', 'Забелязвай моментите, в които се оплакваш, и ги заменяй с наблюдение или действие.', 50, 0),
('Седмица осъзнато хранене', 'Яж бавно и без екрани, като обръщаш внимание на вкуса и усещането за ситост.', 50, 0),
('Мини проект за 7 дни', 'Избери малка идея и работи по нея всеки ден по 10–15 минути.', 50, 0),
('Седмица без multitasking', 'Фокусирай се върху едно нещо в даден момент и тренирай вниманието си да бъде тук и сега.', 50, 0),
('Седмица движение всеки ден', 'Всеки ден отделяй поне 10 минути за движение – разходка, стречинг или леко упражнение.',  50, 0),
('Седмица благодарност', 'Всеки ден записвай или изразявай по една благодарност към човек, ситуация или себе си.', 50, 0),
('Седмица дигитална дисциплина', 'Ограничи ненужните известия и времето в приложенията, които разсейват вниманието ти.', 50, 0),
('Седмица подредено пространство', 'Всеки ден подреждай малка част от средата си и наблюдавай ефекта върху ума си.', 50, 0),
('Седмица фокус върху сън', 'Лягай и ставай по едно и също време, като избягваш екрани поне 1 час преди сън.', 50, 0),
('Седмица без сравнение', 'Съзнателно спирай сравняването си с другите и се фокусирай върху собствения си път.', 50, 0),
('Седмица творческа практика', 'Всеки ден отделяй малко време за творчество – писане, рисуване, музика или друго.', 50, 0),
('Седмица с по-малко думи', 'Говори по-малко и слушай повече, като наблюдаваш как това влияе на отношенията ти.', 50, 0),
('Седмица осъзнато дишане', 'Поне веднъж дневно прави кратка практика с бавно и дълбоко дишане.', 50, 0),
('Седмица само една цел', 'Избери една основна цел за седмицата и насочвай енергията си към нея.', 50, 0),
('Седмица без излишни покупки', 'Купувай само необходимото и наблюдавай импулсите си за харчене.', 50, 0),
('Седмица грижа за себе си', 'Всеки ден прави по едно малко действие, което те зарежда и подкрепя.', 50, 0),
('Седмица наблюдение на навици', 'Без да ги променяш, просто наблюдавай ежедневните си навици и реакции.', 50, 0);
